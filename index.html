<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Absence Tracker</title>

  <style>
    :root{
      --bg: #0b1220;
      --card: rgba(255,255,255,0.06);
      --card2: rgba(255,255,255,0.10);
      --txt: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --muted2: rgba(255,255,255,0.55);
      --line: rgba(255,255,255,0.14);
      --accent: #7dd3fc;   /* jasny niebieski */
      --danger: #fb7185;   /* róż */
      --ok: #34d399;       /* zieleń */
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius: 18px;
    }

    *{ box-sizing: border-box; }
    body{
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background: radial-gradient(1200px 800px at 30% 10%, rgba(125,211,252,0.22), transparent 55%),
                  radial-gradient(900px 700px at 90% 40%, rgba(52,211,153,0.14), transparent 55%),
                  radial-gradient(800px 600px at 30% 95%, rgba(251,113,133,0.10), transparent 55%),
                  var(--bg);
      color: var(--txt);
      min-height: 100dvh;
    }

    .container{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
      padding-bottom: 28px;
    }

    header{
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 14px;
    }

    .app-title{
      font-size: clamp(22px, 4vw, 34px);
      letter-spacing: 0.5px;
      font-weight: 800;
      text-transform: uppercase;
      line-height: 1.15;
    }
    .app-subtitle{
      color: var(--muted);
      font-size: clamp(13px, 2.2vw, 15px);
      line-height: 1.4;
    }

    /* MENU */
    .tabs{
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 14px 0 18px;
    }

    .tab{
      background: var(--card);
      border: 1px solid var(--line);
      color: var(--txt);
      padding: 12px 10px;
      border-radius: 999px;
      cursor: pointer;
      text-align: center;
      font-weight: 800;
      letter-spacing: 0.6px;
      text-transform: uppercase;
      font-size: 13px;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      user-select: none;
    }
    .tab:active{ transform: scale(0.99); }
    .tab.active{
      background: rgba(125,211,252,0.18);
      border-color: rgba(125,211,252,0.45);
      box-shadow: 0 0 0 6px rgba(125,211,252,0.08);
    }

    /* KARTY */
    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    .section-title{
      font-size: clamp(18px, 3vw, 26px);
      text-transform: uppercase;
      letter-spacing: 0.7px;
      font-weight: 900;
      margin: 0 0 4px;
    }
    .section-subtitle{
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.35;
    }

    /* FORM */
    .form-grid{
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }

    .field{
      display: grid;
      gap: 6px;
    }
    label{
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      color: var(--muted);
      font-weight: 800;
    }
    input, select, textarea{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.05);
      color: var(--txt);
      outline: none;
      font-size: 15px;
    }
    textarea{ min-height: 86px; resize: vertical; }

    .row{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .actions{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 6px;
    }
    .btn{
      border: 1px solid var(--line);
      background: var(--card2);
      color: var(--txt);
      padding: 11px 14px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 900;
      letter-spacing: 0.6px;
      text-transform: uppercase;
      font-size: 12px;
      transition: transform .08s ease, filter .2s ease, border-color .2s ease;
      user-select: none;
    }
    .btn:active{ transform: scale(0.99); }
    .btn.primary{
      background: rgba(52,211,153,0.16);
      border-color: rgba(52,211,153,0.40);
    }
    .btn.danger{
      background: rgba(251,113,133,0.14);
      border-color: rgba(251,113,133,0.35);
    }

    /* PODSUMOWANIA */
    .summary{
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 14px;
    }
    .pill{
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.05);
      border-radius: 14px;
      padding: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }
    .pill strong{
      font-size: 12px;
      letter-spacing: 0.7px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .pill span{
      font-weight: 950;
      letter-spacing: 0.3px;
      font-size: 15px;
    }
    .pill .good{ color: var(--ok); }
    .pill .bad{ color: var(--danger); }
    .pill .accent{ color: var(--accent); }

    /* LISTA */
    .list{
      margin-top: 14px;
      border-top: 1px solid var(--line);
      padding-top: 14px;
      display: grid;
      gap: 10px;
    }

    .item{
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.05);
      border-radius: 14px;
      padding: 12px;
      display: grid;
      gap: 6px;
    }
    .item-top{
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 10px;
    }
    .item-title{
      font-weight: 950;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      font-size: 13px;
    }
    .item-meta{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }
    .item-badge{
      font-weight: 950;
      font-size: 12px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.06);
      padding: 6px 10px;
      border-radius: 999px;
      letter-spacing: 0.6px;
      text-transform: uppercase;
      white-space: nowrap;
    }
    .item-actions{
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 4px;
    }
    .mini{
      padding: 9px 10px;
      font-size: 11px;
      border-radius: 12px;
    }

    /* RESPONSYWNOŚĆ */
    @media (min-width: 740px){
      .form-grid{ grid-template-columns: 1fr; }
      .row{ grid-template-columns: 1fr 1fr; }
      .summary{ grid-template-columns: 1fr 1fr 1fr; }
      .tabs{ gap: 12px; }
      .tab{ font-size: 14px; padding: 12px 12px; }
    }

    .hidden{ display: none !important; }
    .footnote{
      margin-top: 14px;
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.35;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <div class="app-title">Absence Tracker</div>
      <div class="app-subtitle">Prosty rejestr nieobecności (mobile-first). Dane zapisują się lokalnie w przeglądarce.</div>

      <div class="tabs" role="tablist" aria-label="Menu">
        <button class="tab active" data-tab="holidays" role="tab" aria-selected="true">Holidays</button>
        <button class="tab" data-tab="sickness" role="tab" aria-selected="false">Sickness</button>
        <button class="tab" data-tab="childcare" role="tab" aria-selected="false">Child care absence</button>
      </div>
    </header>

    <!-- HOLIDAYS -->
    <section id="panel-holidays" class="card" role="tabpanel">
      <h2 class="section-title">Holidays</h2>
      <p class="section-subtitle">
        Brałem Holidays w: dodaj dni z kalendarza (Full day = 1, Half day = 0.5). Wpisy mają kolejne ID.
      </p>

      <div class="form-grid">
        <div class="row">
          <div class="field">
            <label for="h-date">Data</label>
            <input id="h-date" type="date" />
          </div>
          <div class="field">
            <label for="h-type">Typ dnia</label>
            <select id="h-type">
              <option value="1">Full day</option>
              <option value="0.5">Half day</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label for="h-note">Notatka (opcjonalnie)</label>
          <input id="h-note" type="text" placeholder="np. urlop wypoczynkowy / wyjazd" />
        </div>

        <div class="actions">
          <button class="btn primary" id="h-add">Dodaj dzień</button>
          <button class="btn danger" id="h-clear">Wyczyść wszystko</button>
        </div>
      </div>

      <div class="summary">
        <div class="pill">
          <strong>Limit roczny</strong>
          <span class="accent" id="h-limit">25</span>
        </div>
        <div class="pill">
          <strong>Wzięte dni</strong>
          <span id="h-taken">0</span>
        </div>
        <div class="pill">
          <strong>Pozostało</strong>
          <span class="good" id="h-left">25</span>
        </div>
      </div>

      <div class="list" id="h-list"></div>

      <div class="footnote">
        Liczba_dni = 25 − wziete_dni (sumowane: Full=1, Half=0.5). ID jest nadawane kolejno według dodania.
      </div>
    </section>

    <!-- SICKNESS -->
    <section id="panel-sickness" class="card hidden" role="tabpanel">
      <h2 class="section-title">Sickness</h2>
      <p class="section-subtitle">
        Propozycja pól: data, Full/Half, „czy wymagane zwolnienie”, notatka (np. objawy/uwagi).
      </p>

      <div class="form-grid">
        <div class="row">
          <div class="field">
            <label for="s-date">Data</label>
            <input id="s-date" type="date" />
          </div>
          <div class="field">
            <label for="s-type">Typ dnia</label>
            <select id="s-type">
              <option value="1">Full day</option>
              <option value="0.5">Half day</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label for="s-cert">Zwolnienie lekarskie</label>
            <select id="s-cert">
              <option value="Nie">Nie</option>
              <option value="Tak">Tak</option>
            </select>
          </div>
          <div class="field">
            <label for="s-contact">Kontakt do przełożonego (opcjonalnie)</label>
            <input id="s-contact" type="text" placeholder="np. poinformowałem o 08:15" />
          </div>
        </div>

        <div class="field">
          <label for="s-note">Notatka (opcjonalnie)</label>
          <input id="s-note" type="text" placeholder="np. przeziębienie / wizyta u lekarza" />
        </div>

        <div class="actions">
          <button class="btn primary" id="s-add">Dodaj dzień</button>
          <button class="btn danger" id="s-clear">Wyczyść wszystko</button>
        </div>
      </div>

      <div class="summary">
        <div class="pill">
          <strong>Wpisów</strong>
          <span class="accent" id="s-count">0</span>
        </div>
        <div class="pill">
          <strong>Łącznie dni</strong>
          <span id="s-total">0</span>
        </div>
        <div class="pill">
          <strong>Ostatnia data</strong>
          <span id="s-last">—</span>
        </div>
      </div>

      <div class="list" id="s-list"></div>
    </section>

    <!-- CHILD CARE -->
    <section id="panel-childcare" class="card hidden" role="tabpanel">
      <h2 class="section-title">Child care absence</h2>
      <p class="section-subtitle">
        Propozycja pól: data, Full/Half, dziecko (imię), powód (np. choroba dziecka), notatka.
      </p>

      <div class="form-grid">
        <div class="row">
          <div class="field">
            <label for="c-date">Data</label>
            <input id="c-date" type="date" />
          </div>
          <div class="field">
            <label for="c-type">Typ dnia</label>
            <select id="c-type">
              <option value="1">Full day</option>
              <option value="0.5">Half day</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label for="c-child">Dziecko (opcjonalnie)</label>
            <input id="c-child" type="text" placeholder="np. Jan / Zosia" />
          </div>
          <div class="field">
            <label for="c-reason">Powód</label>
            <select id="c-reason">
              <option value="Choroba dziecka">Choroba dziecka</option>
              <option value="Opieka / przedszkole zamknięte">Opieka / przedszkole zamknięte</option>
              <option value="Wizyta lekarska dziecka">Wizyta lekarska dziecka</option>
              <option value="Inne">Inne</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label for="c-note">Notatka (opcjonalnie)</label>
          <input id="c-note" type="text" placeholder="np. gorączka, odbiór z przedszkola" />
        </div>

        <div class="actions">
          <button class="btn primary" id="c-add">Dodaj dzień</button>
          <button class="btn danger" id="c-clear">Wyczyść wszystko</button>
        </div>
      </div>

      <div class="summary">
        <div class="pill">
          <strong>Wpisów</strong>
          <span class="accent" id="c-count">0</span>
        </div>
        <div class="pill">
          <strong>Łącznie dni</strong>
          <span id="c-total">0</span>
        </div>
        <div class="pill">
          <strong>Ostatnia data</strong>
          <span id="c-last">—</span>
        </div>
      </div>

      <div class="list" id="c-list"></div>
    </section>
  </div>

  <script>
    /**********************
     *  Proste przechowywanie danych w localStorage
     **********************/
    const STORAGE_KEY = "absence_tracker_v1";

    const state = loadState();

    function loadState(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return {
          holidays: [],
          sickness: [],
          childcare: []
        };
        const parsed = JSON.parse(raw);
        // minimalna walidacja
        return {
          holidays: Array.isArray(parsed.holidays) ? parsed.holidays : [],
          sickness: Array.isArray(parsed.sickness) ? parsed.sickness : [],
          childcare: Array.isArray(parsed.childcare) ? parsed.childcare : []
        };
      }catch(e){
        return { holidays: [], sickness: [], childcare: [] };
      }
    }

    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function nextId(list){
      // kolejne ID oparte o maks + 1, stabilne nawet po usuwaniu
      const max = list.reduce((m, x) => Math.max(m, Number(x.id || 0)), 0);
      return max + 1;
    }

    function fmtDate(iso){
      if(!iso) return "—";
      // iso: YYYY-MM-DD
      const [y,m,d] = iso.split("-");
      return `${d}.${m}.${y}`;
    }

    function safeNumber(x){
      const n = Number(x);
      return Number.isFinite(n) ? n : 0;
    }

    function sumDays(list){
      // Full=1, Half=0.5
      return list.reduce((acc, item) => acc + safeNumber(item.dayValue), 0);
    }

    /**********************
     *  TABY
     **********************/
    const tabs = document.querySelectorAll(".tab");
    const panels = {
      holidays: document.getElementById("panel-holidays"),
      sickness: document.getElementById("panel-sickness"),
      childcare: document.getElementById("panel-childcare")
    };

    tabs.forEach(btn => {
      btn.addEventListener("click", () => activateTab(btn.dataset.tab));
    });

    function activateTab(key){
      tabs.forEach(t => {
        const active = (t.dataset.tab === key);
        t.classList.toggle("active", active);
        t.setAttribute("aria-selected", active ? "true" : "false");
      });
      Object.keys(panels).forEach(k => {
        panels[k].classList.toggle("hidden", k !== key);
      });
    }

    /**********************
     *  HOLIDAYS
     **********************/
    const HOLIDAYS_LIMIT = 25;

    const hDate = document.getElementById("h-date");
    const hType = document.getElementById("h-type");
    const hNote = document.getElementById("h-note");
    const hAdd = document.getElementById("h-add");
    const hClear = document.getElementById("h-clear");
    const hList = document.getElementById("h-list");

    const hLimitEl = document.getElementById("h-limit");
    const hTakenEl = document.getElementById("h-taken");
    const hLeftEl = document.getElementById("h-left");

    hLimitEl.textContent = String(HOLIDAYS_LIMIT);

    hAdd.addEventListener("click", () => {
      const date = hDate.value;
      const dayValue = Number(hType.value); // 1 lub 0.5
      const note = (hNote.value || "").trim();

      if(!date){
        alert("Wybierz datę.");
        return;
      }

      // blokada duplikatu tej samej daty (opcjonalna, ale praktyczna)
      const exists = state.holidays.some(x => x.date === date);
      if(exists){
        alert("Ten dzień już istnieje w Holidays. Usuń go lub wybierz inną datę.");
        return;
      }

      const taken = sumDays(state.holidays);
      const leftAfter = HOLIDAYS_LIMIT - (taken + dayValue);
      if(leftAfter < 0){
        alert("Przekraczasz limit Holidays (25 dni). Zmień Half/Full albo usuń inne wpisy.");
        return;
      }

      state.holidays.push({
        id: nextId(state.holidays),
        date,
        dayValue,
        dayType: dayValue === 1 ? "Full day" : "Half day",
        note
      });

      saveState();
      renderAll();

      // UX: zostaw datę pustą, notatkę czyść
      hDate.value = "";
      hNote.value = "";
      hType.value = "1";
    });

    hClear.addEventListener("click", () => {
      if(!confirm("Na pewno wyczyścić wszystkie wpisy Holidays?")) return;
      state.holidays = [];
      saveState();
      renderAll();
    });

    function renderHolidays(){
      const taken = sumDays(state.holidays);
      const left = HOLIDAYS_LIMIT - taken;

      hTakenEl.textContent = String(taken % 1 === 0 ? taken.toFixed(0) : taken.toFixed(1));
      hLeftEl.textContent = String(left % 1 === 0 ? left.toFixed(0) : left.toFixed(1));
      hLeftEl.classList.toggle("bad", left <= 2);
      hLeftEl.classList.toggle("good", left > 2);

      // sortuj po dacie rosnąco
      const list = [...state.holidays].sort((a,b) => (a.date || "").localeCompare(b.date || ""));

      hList.innerHTML = "";
      if(list.length === 0){
        hList.innerHTML = `<div class="item"><div class="item-meta">Brak wpisów. Dodaj pierwszy dzień z kalendarza.</div></div>`;
        return;
      }

      list.forEach(item => {
        const el = document.createElement("div");
        el.className = "item";

        el.innerHTML = `
          <div class="item-top">
            <div class="item-title">ID ${item.id} • ${fmtDate(item.date)}</div>
            <div class="item-badge">${item.dayType}</div>
          </div>
          <div class="item-meta">
            <div><strong>Dni:</strong> ${item.dayValue}</div>
            ${item.note ? `<div><strong>Notatka:</strong> ${escapeHtml(item.note)}</div>` : ""}
          </div>
          <div class="item-actions">
            <button class="btn mini danger" data-action="delete" data-id="${item.id}">Usuń</button>
          </div>
        `;

        el.querySelector('[data-action="delete"]').addEventListener("click", () => {
          state.holidays = state.holidays.filter(x => x.id !== item.id);
          saveState();
          renderAll();
        });

        hList.appendChild(el);
      });
    }

    /**********************
     *  SICKNESS
     **********************/
    const sDate = document.getElementById("s-date");
    const sType = document.getElementById("s-type");
    const sCert = document.getElementById("s-cert");
    const sContact = document.getElementById("s-contact");
    const sNote = document.getElementById("s-note");
    const sAdd = document.getElementById("s-add");
    const sClear = document.getElementById("s-clear");
    const sList = document.getElementById("s-list");

    const sCountEl = document.getElementById("s-count");
    const sTotalEl = document.getElementById("s-total");
    const sLastEl = document.getElementById("s-last");

    sAdd.addEventListener("click", () => {
      const date = sDate.value;
      const dayValue = Number(sType.value);
      if(!date){
        alert("Wybierz datę.");
        return;
      }

      // pozwalamy na duplikaty w Sickness? Zwykle nie — blokujemy dla porządku:
      if(state.sickness.some(x => x.date === date)){
        alert("Ten dzień już istnieje w Sickness.");
        return;
      }

      state.sickness.push({
        id: nextId(state.sickness),
        date,
        dayValue,
        dayType: dayValue === 1 ? "Full day" : "Half day",
        cert: sCert.value,
        contact: (sContact.value || "").trim(),
        note: (sNote.value || "").trim()
      });

      saveState();
      renderAll();

      sDate.value = "";
      sType.value = "1";
      sCert.value = "Nie";
      sContact.value = "";
      sNote.value = "";
    });

    sClear.addEventListener("click", () => {
      if(!confirm("Na pewno wyczyścić wszystkie wpisy Sickness?")) return;
      state.sickness = [];
      saveState();
      renderAll();
    });

    function renderSickness(){
      const total = sumDays(state.sickness);
      const list = [...state.sickness].sort((a,b) => (a.date || "").localeCompare(b.date || ""));

      sCountEl.textContent = String(list.length);
      sTotalEl.textContent = String(total % 1 === 0 ? total.toFixed(0) : total.toFixed(1));
      sLastEl.textContent = list.length ? fmtDate(list[list.length - 1].date) : "—";

      sList.innerHTML = "";
      if(list.length === 0){
        sList.innerHTML = `<div class="item"><div class="item-meta">Brak wpisów. Dodaj dzień chorobowy.</div></div>`;
        return;
      }

      list.forEach(item => {
        const el = document.createElement("div");
        el.className = "item";
        el.innerHTML = `
          <div class="item-top">
            <div class="item-title">ID ${item.id} • ${fmtDate(item.date)}</div>
            <div class="item-badge">${item.dayType}</div>
          </div>
          <div class="item-meta">
            <div><strong>Dni:</strong> ${item.dayValue}</div>
            <div><strong>Zwolnienie:</strong> ${escapeHtml(item.cert || "Nie")}</div>
            ${item.contact ? `<div><strong>Info:</strong> ${escapeHtml(item.contact)}</div>` : ""}
            ${item.note ? `<div><strong>Notatka:</strong> ${escapeHtml(item.note)}</div>` : ""}
          </div>
          <div class="item-actions">
            <button class="btn mini danger" data-action="delete" data-id="${item.id}">Usuń</button>
          </div>
        `;

        el.querySelector('[data-action="delete"]').addEventListener("click", () => {
          state.sickness = state.sickness.filter(x => x.id !== item.id);
          saveState();
          renderAll();
        });

        sList.appendChild(el);
      });
    }

    /**********************
     *  CHILD CARE
     **********************/
    const cDate = document.getElementById("c-date");
    const cType = document.getElementById("c-type");
    const cChild = document.getElementById("c-child");
    const cReason = document.getElementById("c-reason");
    const cNote = document.getElementById("c-note");
    const cAdd = document.getElementById("c-add");
    const cClear = document.getElementById("c-clear");
    const cList = document.getElementById("c-list");

    const cCountEl = document.getElementById("c-count");
    const cTotalEl = document.getElementById("c-total");
    const cLastEl = document.getElementById("c-last");

    cAdd.addEventListener("click", () => {
      const date = cDate.value;
      const dayValue = Number(cType.value);
      if(!date){
        alert("Wybierz datę.");
        return;
      }

      if(state.childcare.some(x => x.date === date)){
        alert("Ten dzień już istnieje w Child care absence.");
        return;
      }

      state.childcare.push({
        id: nextId(state.childcare),
        date,
        dayValue,
        dayType: dayValue === 1 ? "Full day" : "Half day",
        child: (cChild.value || "").trim(),
        reason: cReason.value,
        note: (cNote.value || "").trim()
      });

      saveState();
      renderAll();

      cDate.value = "";
      cType.value = "1";
      cChild.value = "";
      cReason.value = "Choroba dziecka";
      cNote.value = "";
    });

    cClear.addEventListener("click", () => {
      if(!confirm("Na pewno wyczyścić wszystkie wpisy Child care absence?")) return;
      state.childcare = [];
      saveState();
      renderAll();
    });

    function renderChildcare(){
      const total = sumDays(state.childcare);
      const list = [...state.childcare].sort((a,b) => (a.date || "").localeCompare(b.date || ""));

      cCountEl.textContent = String(list.length);
      cTotalEl.textContent = String(total % 1 === 0 ? total.toFixed(0) : total.toFixed(1));
      cLastEl.textContent = list.length ? fmtDate(list[list.length - 1].date) : "—";

      cList.innerHTML = "";
      if(list.length === 0){
        cList.innerHTML = `<div class="item"><div class="item-meta">Brak wpisów. Dodaj nieobecność z tytułu opieki.</div></div>`;
        return;
      }

      list.forEach(item => {
        const el = document.createElement("div");
        el.className = "item";
        el.innerHTML = `
          <div class="item-top">
            <div class="item-title">ID ${item.id} • ${fmtDate(item.date)}</div>
            <div class="item-badge">${item.dayType}</div>
          </div>
          <div class="item-meta">
            <div><strong>Dni:</strong> ${item.dayValue}</div>
            ${item.child ? `<div><strong>Dziecko:</strong> ${escapeHtml(item.child)}</div>` : ""}
            <div><strong>Powód:</strong> ${escapeHtml(item.reason || "—")}</div>
            ${item.note ? `<div><strong>Notatka:</strong> ${escapeHtml(item.note)}</div>` : ""}
          </div>
          <div class="item-actions">
            <button class="btn mini danger" data-action="delete" data-id="${item.id}">Usuń</button>
          </div>
        `;

        el.querySelector('[data-action="delete"]').addEventListener("click", () => {
          state.childcare = state.childcare.filter(x => x.id !== item.id);
          saveState();
          renderAll();
        });

        cList.appendChild(el);
      });
    }

    /**********************
     *  Render całości + drobne utils
     **********************/
    function renderAll(){
      renderHolidays();
      renderSickness();
      renderChildcare();
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // ustaw domyślną datę na dziś (dla wygody)
    (function init(){
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth()+1).padStart(2,"0");
      const dd = String(today.getDate()).padStart(2,"0");
      const iso = `${yyyy}-${mm}-${dd}`;

      // Nie wymuszamy, tylko podpowiadamy (możesz odkomentować, jeśli chcesz auto-uzupełnianie):
      // hDate.value = iso; sDate.value = iso; cDate.value = iso;

      renderAll();
    })();
  </script>
</body>
</html>